class Vector{constructor(t,e){this.x=t,this.y=e}normalize(){const t=this.calcAng();return this.x=Math.cos(t),this.y=Math.sin(t),this}copy(){return new Vector(this.x,this.y)}calcAng(){return Math.atan2(this.y,this.x)}add(t){return this.x+=t.x,this.y+=t.y,this}static add(t,e){const i=t.x+e.x,s=t.y+e.y;return new Vector(i,s)}sub(t){return this.x-=t.x,this.y-=t.y,this}static sub(t,e){const i=t.x-e.x,s=t.y-e.y;return new Vector(i,s)}dot(t){return this.x*t.x+this.y*t.y}static dot(t,e){return t.x*e.x+t.y*e.y}cross(t){return this.x*t.y-this.y*t.x}static cross(t,e){return t.x*e.y-t.y*e.x}multiply(t){return this.x*=t,this.y*=t,this}getMag(){return Math.sqrt(this.x*this.x+this.y*this.y)}getMagSq(){return this.x*this.x+this.y*this.y}setMag(t){return this.normalize(),this.multiply(t),this}limit(t){return this.getMagSq()>t*t&&this.setMag(t),this}setAng(t){return this.x=Math.cos(t),this.y=Math.sin(t),this}set(t,e){return this.x=t,this.y=e,this}}class Emitter{constructor(){this.events={}}on(t,e){this.events[t]=this.events[t]||[],this.events[t].push(e)}emit(t,...e){this.events.hasOwnProperty(t)&&this.events[t].forEach(t=>t(...e))}}class RubIt extends Emitter{constructor(t){super(),this.args={container_id:t.container_id||!1,type:t.type||"dynamic",area_width:t.area_width||"auto",area_height:t.area_height||"auto",outer_rad:t.outer_rad||"100px",inner_rad:t.inner_rad||"60px",outer_bg:t.outer_bg||"radial-gradient(#56CCF2 0%, #2F80ED 100%)",outer_border:t.outer_border||"none",inner_bg:t.inner_bg||"radial-gradient(#56CCF2 0%, #2F80ED 100%)",inner_border:t.inner_border||"1px solid #2F80ED"},this.build(),this.stylize(),this.init(),this.pressed=!1}build(){this.el_area=document.createElement("div"),this.el_area.classList.add("rubit_area"),this.el_container=document.createElement("div"),this.el_container.classList.add("rubit_container"),this.el_outer=document.createElement("div"),this.el_outer.classList.add("rubit_outer"),this.el_inner=document.createElement("div"),this.el_inner.classList.add("rubit_inner"),this.el_outer.appendChild(this.el_inner),this.el_container.appendChild(this.el_outer),this.el_area.appendChild(this.el_container),this.args.container_id?document.getElementById(this.args.container_id).appendChild(this.el_area):document.body.appendChild(this.el_area)}stylize(){const t={position:"relative",width:this.args.area_width,height:this.args.area_height,"box-sizing":"border-box"},e={position:"relative",display:"flex","justify-content":"center","align-items":"center",border:this.args.outer_border,background:this.args.outer_bg,"border-radius":"50%",width:this.args.outer_rad,height:this.args.outer_rad,"box-sizing":"border-box"},i={position:"relative",border:this.args.inner_border,background:this.args.inner_bg,"border-radius":"50%",width:this.args.inner_rad,height:this.args.inner_rad,"box-sizing":"border-box"};this.applyStyle(t,this.el_area),this.applyStyle({position:"relative",display:"inline-block","box-sizing":"border-box"},this.el_container),this.applyStyle(e,this.el_outer),this.applyStyle(i,this.el_inner)}applyStyle(t,e){for(const i in t)e.style[i]=t[i]}init(){const t=this.mouseDown.bind(this),e=this.mouseMove.bind(this),i=this.mouseUp.bind(this);document.addEventListener("mousedown",t),document.addEventListener("mousemove",e),document.addEventListener("mouseup",i),document.addEventListener("touchstart",t),document.addEventListener("touchmove",e,{passive:!1}),document.addEventListener("touchend",i);const s=this.el_container.offsetTop,n=this.el_container.offsetLeft;this.center=new Vector(n,s),this.inner=new Vector(0,0)}dynamic(t){let e,i;t.changedTouches?(i=t.changedTouches[0].pageY-window.scrollY,e=t.changedTouches[0].pageX-window.scrollX):(i=t.pageY-window.scrollY,e=t.pageX-window.scrollX);const s=this.el_area.getBoundingClientRect(),n=i-s.top-this.el_container.offsetHeight/2,r=e-s.left-this.el_container.offsetWidth/2;this.el_container.style.top=`${n}px`,this.el_container.style.left=`${r}px`,this.center.set(r,n),this.emit("reposition")}mouseDown(t){t.preventDefault(),this.pressed=!0,"dynamic"===this.args.type&&this.dynamic(t),this.el_inner.style.transition="none",this.mouseMove(t),this.emit("press")}mouseMove(t){if(t.preventDefault(),this.pressed){let e,i;t.changedTouches?(i=t.changedTouches[0].pageY-window.scrollY,e=t.changedTouches[0].pageX-window.scrollX):(i=t.pageY-window.scrollY,e=t.pageX-window.scrollX);const s=this.el_area.getBoundingClientRect(),n=this.el_container.getBoundingClientRect(),r=i-s.top-n.height/2,h=e-s.left-n.width/2;this.inner.set(h,r);const o=Vector.sub(this.inner,this.center).limit(n.width/2);this.el_inner.style.top=`${o.y}px`,this.el_inner.style.left=`${o.x}px`;const a=o.x/(n.width/2),d=-o.y/(n.height/2),l={x:a,y:d,distance:Math.sqrt(a**2+d**2),angle:180*Math.atan2(d,a)/Math.PI};this.emit("move",l)}}mouseUp(t){t.preventDefault(),this.pressed=!1,this.el_inner.style.transition="all .1s ease-out 0s",this.el_inner.style.top="0px",this.el_inner.style.left="0px",this.emit("move",{x:0,y:0,distance:0,angle:0}),this.emit("release")}}